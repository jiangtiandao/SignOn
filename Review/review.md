# 开发过程记录
## 1.踩坑阶段
### 框架之坑
#### 1. 《架构探险》一书中实现的框架
- 注解：在控制器上使用Controller注解，在控制器类的方法上使用Action注解，在服务类上使用Service注解，在控制器类中可使用Inject注解将服务类依赖注入。
- 类加载器：加载使用某注解的类、实现某个接口的类或者继承某父类的所有子类等。
  - 获取类： `Class.forName(className, isInitialized, getClassLoader())`
  - 获取指定包名下所有类：将包名转换为文件路径，读取class或jar包，获取指定的类名去加载类。
  - 获取使用某注解的类：先自定义注解(`@Controller`,`@Service`等)，可以将带有这些注解的类所产上的对象理解为由框架管理的bean。
  封装助手方法，将上述类获取到一个类集合中。
- Bean容器：获取bean类集合，根据类来实例化对象，再将创建的对象放在一个静态的`Map<Class<?>,Object>`中。
- 依赖注入：获取所有的BeanMap(即实现Bean容器步骤中创建的静态Map)，遍历这个映射关系，分别取出Bean类与实例，进而通过反射获取类中所有的成员变量，继续遍历这些成员变量，判断这些成员变量是否带有注解，若带有DI注解，则从BeanMap中取出Bean实例，修改实例域的值。
- 加载Controller：获取所有定义了Controller注解的类，通过反射获取这些类中所有带有Action注解的方法，获取Action注解中的请求表达式，进而获取请求方法与请求路径。封装一个请求对象(Request)与处理对象(Handler)，最后将Request与Handler建立映射关系，放入一个ActionMap中，并提供一个可根据请求方法与请求路径获取处理对象的方法。
- 初始化：加载上述类的静态模块。
- 请求转发器：创建一个Servlet来处理所有的请求，根据请求信息与请求路径来调用具体的Action方法。
###### 问题keng
作者给这个框架起名叫smart，然而这个框架并不smart，相反我个人认为它很stupid，因为它使用了太多的静态代码块和静态方法，而且在初始化框架的时候实际的执行顺序和作者预期的不一致，实际上这个框架本身根本不能正常运行，我想这大概也是这本书在网上评价不高的原因吧。  
此外，框架功能的实现代码写的并不好，非常难以看懂，作为初级开发人员，我闻到了熟悉的“硬写”的味道，让我想起了刚入职的时候为了做题写的元素是链表的二维数组，指导我的小哥测试了功能之后拒绝对我充满了List***的代码做出评价。这类代码都通过繁琐的逻辑直接实现功能，难以阅读和维护。当然，对于写出这些代码的人，也许他的逻辑思维和hold住的代码量有些许增加。

#### 2. Spring MVC
